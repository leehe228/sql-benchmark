SELECT * FROM posts CROSS JOIN (SELECT post_timings.topic_id, post_timings.post_number, EXP(AVG(msecs)) AS gmean FROM post_timings INNER JOIN posts AS p2 ON p2.post_number = post_timings.post_number AND p2.topic_id = post_timings.topic_id AND p2.user_id <> post_timings.user_id GROUP BY post_timings.topic_id, post_timings.post_number) AS x WHERE x.topic_id = posts.topic_id AND x.post_number = posts.post_number AND (posts.avg_time <> x.gmean / 1000 OR posts.avg_time IS NULL) AND posts.topic_id IN (SELECT id FROM topics WHERE bumped_at > '2004-01-01T00:00:00')