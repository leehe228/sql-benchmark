SELECT distinct "posts".* FROM "posts" INNER JOIN "post_search_data" ON "post_search_data"."post_id" = "posts"."id" INNER JOIN "topics" ON "topics"."id" = "posts"."topic_id" AND ("topics"."deleted_at" IS NULL) LEFT JOIN categories ON categories.id = topics.category_id WHERE ("posts"."deleted_at" IS NULL) AND "posts"."post_type" IN (1, 2, 3) AND (topics.visible) AND ( topics.archetype <> 'private_message' ) AND ( topics.id IN ( SELECT distinct tt.topic_id FROM topic_tags tt WHERE tt.tag_id in ( SELECT distinct tag_id FROM tag_group_memberships WHERE tag_group_id = 504 ) ) ) AND ( categories.id NOT IN ( SELECT distinct categories.id WHERE categories.search_priority = 1 ) ) AND ( (categories.id IS NULL) OR (NOT categories.read_restricted) ) AND ( posts.topic_id NOT in (18674, 18673, 18672) ) ORDER BY posts.created_at DESC LIMIT 9 OFFSET 0"