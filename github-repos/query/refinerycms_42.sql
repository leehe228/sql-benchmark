SELECT COUNT(*) FROM `refinery_pages` LEFT OUTER JOIN `refinery_pages` `parent` ON `parent`.`id` = `refinery_pages`.`parent_id` WHERE (((`refinery_pages`.`lft` IS NULL OR `refinery_pages`.`rgt` IS NULL) OR `refinery_pages`.`lft` >= `refinery_pages`.`rgt`) OR `refinery_pages`.`parent_id` IS NOT NULL AND (`refinery_pages`.`lft` <= `parent`.`lft` OR `refinery_pages`.`rgt` >= `parent`.`rgt`))