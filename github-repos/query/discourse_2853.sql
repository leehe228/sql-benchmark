SELECT "tags".* FROM "tags" WHERE (tags.topic_count > 0) AND "tags"."target_tag_id" IS NULL AND (tags.id NOT IN (SELECT "tags"."id" FROM "tags" INNER JOIN "tag_group_memberships" ON "tag_group_memberships"."tag_id" = "tags"."id" INNER JOIN "tag_groups" ON "tag_groups"."id" = "tag_group_memberships"."tag_group_id" WHERE (tag_groups.id NOT IN ( SELECT tag_group_id FROM tag_group_permissions WHERE group_id = 0))))