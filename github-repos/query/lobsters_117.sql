SELECT `stories`.* FROM `stories` INNER JOIN `taggings` ON `taggings`.`story_id` = `stories`.`id` INNER JOIN `tags` ON `tags`.`id` = `taggings`.`tag_id` INNER JOIN `users` ON `users`.`id` = `stories`.`user_id` WHERE `stories`.`merged_story_id` IS NULL AND `stories`.`is_expired` = FALSE AND (((stories.title) LIKE '%term1%' OR (stories.description) LIKE '%term1%' OR (stories.story_cache) LIKE '%term1%')) AND `tags`.`tag` IN ('tag1', 'tag2') GROUP BY stories.id HAVING (COUNT(stories.id) = 2) ORDER BY (((stories.title) LIKE '%term1%') * 2) DESC, (((stories.description) LIKE '%term1%') * 1.5) DESC, ((stories.story_cache) LIKE '%term1%') DESC LIMIT 20 OFFSET 0