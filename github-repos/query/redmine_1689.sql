SELECT COUNT(*) FROM `versions` INNER JOIN `projects` ON `projects`.`id` = `versions`.`project_id` WHERE ( projects.id = 1 OR ( projects.status <> 9 AND ( versions.sharing = 'system' OR ( projects.lft >= 1 AND projects.rgt <= 10 AND versions.sharing = 'tree' ) OR ( projects.lft < 1 AND projects.rgt > 10 AND versions.sharing IN ('hierarchy', 'descendants') ) OR ( projects.lft > 1 AND projects.rgt < 10 AND versions.sharing = 'hierarchy' ) ) ) ) AND ( ( ( projects.status <> 9 AND projects.id IN ( SELECT em.project_id FROM enabled_modules em WHERE em.name = 'issue_tracking' ) ) AND ( ( projects.is_public = TRUE AND projects.id NOT IN ( SELECT project_id FROM members WHERE user_id IN (3, 12) ) ) OR projects.id IN (1) ) ) ) 