SELECT COUNT(DISTINCT posts.topic_id) AS count_distinct_posts_topic_id, incoming_domains.name AS incoming_domains_name FROM "incoming_links" INNER JOIN "posts" ON "posts"."id" = "incoming_links"."post_id" AND ("posts"."deleted_at" IS NOT NULL) INNER JOIN "topics" ON "topics"."id" = "posts"."topic_id" AND ("topics"."deleted_at" IS NOT NULL) INNER JOIN "incoming_referers" ON "incoming_referers"."id" = "incoming_links"."incoming_referer_id" INNER JOIN "incoming_domains" ON "incoming_domains"."id" = "incoming_referers"."incoming_domain_id" WHERE (topics.archetype = 'regular') AND ("topics"."deleted_at" IS NOT NULL) AND (incoming_links.created_at > '2009-12-02 06:00:00' AND incoming_domains.name IN ('test.com','foo.com')) GROUP BY incoming_domains.name