SELECT `spree_variants`.* FROM `spree_variants` INNER JOIN `spree_stock_items` ON `spree_stock_items`.`deleted_at` IS NULL AND `spree_stock_items`.`variant_id` = `spree_variants`.`id` WHERE `spree_variants`.`deleted_at` IS NULL AND (`spree_variants`.count_on_hand > 0 OR track_inventory = FALSE)