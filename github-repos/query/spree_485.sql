SELECT DISTINCT `spree_promotions`.`id` AS alias_0, `spree_promotions`.`id` FROM `spree_promotions` LEFT OUTER JOIN `spree_promotion_rules` ON `spree_promotion_rules`.`promotion_id` = `spree_promotions`.`id` LEFT OUTER JOIN `spree_promotion_actions` ON `spree_promotion_actions`.`deleted_at` IS NULL AND `spree_promotion_actions`.`promotion_id` = `spree_promotions`.`id` WHERE (spree_promotions.starts_at IS NULL OR spree_promotions.starts_at < '2020-05-01 07:06:54.255944') AND (spree_promotions.expires_at IS NULL OR spree_promotions.expires_at > '2020-05-01 07:06:54.256111') AND (lower(spree_promotions.code) = 'zxr') AND `spree_promotion_actions`.`id` IS NOT NULL ORDER BY `spree_promotions`.`id` ASC LIMIT 1