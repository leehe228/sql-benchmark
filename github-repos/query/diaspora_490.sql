(SELECT DISTINCT posts.id, posts.updated_at AS updated_at, posts.created_at AS created_at FROM `posts` LEFT OUTER JOIN share_visibilities ON share_visibilities.shareable_id = posts.id AND share_visibilities.shareable_type = 'Post' WHERE `posts`.`author_id` IN (1, 2) AND (`share_visibilities`.`user_id` = 3 AND `share_visibilities`.`shareable_type` = 'Post' AND `share_visibilities`.`hidden` = FALSE OR `posts`.`public` = TRUE) AND `posts`.`type` IN ('StatusMessage', 'Reshare') AND `posts`.`created_at` < '2020-04-29 10:16:05' ORDER BY posts.created_at DESC LIMIT 40) UNION ALL (SELECT DISTINCT posts.id, posts.updated_at AS updated_at, posts.created_at AS created_at FROM `posts` LEFT OUTER JOIN aspect_visibilities ON aspect_visibilities.shareable_id = posts.id AND aspect_visibilities.shareable_type = 'Post' WHERE `posts`.`author_id` = 3 AND `posts`.`type` IN ('StatusMessage', 'Reshare') AND (`aspect_visibilities`.`aspect_id` IN (3, 4) OR `posts`.`public` = TRUE) AND `posts`.`created_at` < '2020-04-29 10:16:05' ORDER BY posts.created_at DESC LIMIT 40) ORDER BY created_at DESC LIMIT 40