SELECT COUNT(DISTINCT `spree_adjustments`.`order_id`) FROM `spree_adjustments` INNER JOIN `spree_orders` ON `spree_orders`.`id` = `spree_adjustments`.`order_id` WHERE `spree_adjustments`.`source_type` = 'Spree::PromotionAction' AND `spree_adjustments`.`eligible` = TRUE AND `spree_orders`.`completed_at` IS NOT NULL AND `spree_orders`.`id` != 421 AND `spree_adjustments`.`source_id` IN (SELECT `spree_promotion_actions`.`id` FROM `spree_promotion_actions` WHERE `spree_promotion_actions`.`deleted_at` IS NULL AND `spree_promotion_actions`.`promotion_id` = 55)