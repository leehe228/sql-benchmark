SELECT DISTINCT `spree_promotions`.* FROM `spree_promotions` LEFT OUTER JOIN `spree_order_promotions` ON `spree_promotions`.`id` = `spree_order_promotions`.`promotion_id` WHERE ( spree_promotions.starts_at IS NULL OR spree_promotions.starts_at < '2020-05-06 04:33:11.947631' ) AND ( spree_promotions.expires_at IS NULL OR spree_promotions.expires_at > '2020-05-06 04:33:11.947825' ) AND ( `spree_promotions`.`code` IS NULL AND `spree_promotions`.`path` IS NULL OR `spree_order_promotions`.`order_id` = 1 ) 