SELECT COUNT(*) FROM (SELECT DISTINCT `spree_products_taxons`.`position` FROM `spree_products` INNER JOIN `spree_variants` ON `spree_variants`.`is_master` = TRUE AND `spree_variants`.`product_id` = `spree_products`.`id` INNER JOIN `spree_prices` ON `spree_prices`.`currency` = 'USD' AND `spree_prices`.`country_iso` IS NULL AND `spree_prices`.`variant_id` = `spree_variants`.`id` INNER JOIN `spree_variants` `variants_including_masters_spree_products_join` ON `variants_including_masters_spree_products_join`.`deleted_at` IS NULL AND `variants_including_masters_spree_products_join`.`product_id` = `spree_products`.`id` INNER JOIN `spree_prices` `prices_spree_products` ON `prices_spree_products`.`deleted_at` IS NULL AND `prices_spree_products`.`variant_id` = `variants_including_masters_spree_products_join`.`id` LEFT OUTER JOIN `spree_products_taxons` ON `spree_products_taxons`.`product_id` = `spree_products`.`id` WHERE `spree_products`.`deleted_at` IS NULL AND EXISTS (SELECT `spree_prices`.* FROM `spree_prices` WHERE `spree_prices`.`deleted_at` IS NULL AND `spree_variants`.`id` = `spree_prices`.`variant_id`) AND (`spree_products`.available_on <= '2020-05-16 05:23:22.762367') AND `spree_products_taxons`.`taxon_id` = 280 AND (`spree_prices`.`amount` BETWEEN 18.0 AND 20.0 OR `spree_prices`.`amount` >= 20.0) AND `spree_prices`.`deleted_at` IS NULL AND `spree_prices`.`currency` = 'USD' AND `spree_prices`.`country_iso` IS NULL) subquery_for_count