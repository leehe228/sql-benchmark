SELECT DISTINCT `spree_promotions`.`id` AS alias_0, `spree_promotions`.`id` FROM `spree_promotions` INNER JOIN `spree_order_promotions` ON `spree_promotions`.`id` = `spree_order_promotions`.`promotion_id` LEFT OUTER JOIN `spree_promotion_actions` ON `spree_promotion_actions`.`deleted_at` IS NULL AND `spree_promotion_actions`.`promotion_id` = `spree_promotions`.`id` WHERE `spree_order_promotions`.`order_id` = 360 AND (lower(spree_promotions.code) = 'line_item_promo') AND `spree_promotion_actions`.`id` IS NOT NULL ORDER BY `spree_promotions`.`id` ASC LIMIT 1