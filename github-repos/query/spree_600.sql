SELECT DISTINCT `spree_variants`.* FROM `spree_variants` INNER JOIN `spree_prices` ON `spree_prices`.`deleted_at` IS NULL AND `spree_prices`.`variant_id` = `spree_variants`.`id` WHERE `spree_variants`.`deleted_at` IS NULL AND (`spree_variants`.`is_master` = FALSE OR ( `spree_variants`.id IN ( SELECT MIN(`spree_variants`.id) FROM `spree_variants` GROUP BY `spree_variants`.product_id HAVING COUNT(*) = 1 ) )) AND (spree_prices.currency = 'USD') AND (spree_prices.amount IS NOT NULL) AND `spree_variants`.`sku` LIKE '%FOO%' LIMIT 25 OFFSET 0