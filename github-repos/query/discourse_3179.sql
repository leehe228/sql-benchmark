SELECT "topics".* FROM "topics" LEFT OUTER JOIN topic_users AS tu ON (topics.id = tu.topic_id AND tu.user_id = 5276) LEFT JOIN user_archived_messages um ON um.user_id = 5276 AND um.topic_id = topics.id WHERE ("topics"."deleted_at" IS NOT NULL) AND (topics.id IN (SELECT topic_id FROM topic_allowed_users WHERE user_id = 5276)) AND "topics"."archetype" = 'private_message' AND "topics"."visible" = TRUE AND (um.user_id IS NULL) AND (NOT (topics.participant_count = 1 AND topics.user_id = 5276 AND topics.moderator_posts_count = 0)) ORDER BY topics.bumped_at DESC LIMIT 30