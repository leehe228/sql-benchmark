SELECT COUNT(*) AS count_all, `opportunities`.`stage` AS opportunities_stage FROM `opportunities` WHERE ((`opportunities`.`assigned_to` = 1148) OR ((`opportunities`.`user_id` = 1148) OR (`opportunities`.`access` = 'Public'))) AND `opportunities`.`stage` IN ('prospecting', 'analysis', 'presentation', 'proposal', 'negotiation', 'final_review', 'won', 'lost') GROUP BY `opportunities`.`stage`