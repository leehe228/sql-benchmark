SELECT user_actions.user_id, COUNT(*) FROM "user_actions" INNER JOIN "topics" ON "topics"."id" = "user_actions"."target_topic_id" AND ("topics"."deleted_at" IS NOT NULL) INNER JOIN "posts" ON "posts"."id" = "user_actions"."target_post_id" AND ("posts"."deleted_at" IS NOT NULL) WHERE ("topics"."deleted_at" IS NOT NULL) AND (topics.archetype <> 'private_message') AND "topics"."visible" = TRUE AND (topics.category_id IS NULL OR topics.category_id IN (SELECT id FROM categories WHERE NOT read_restricted)) AND "user_actions"."action_type" = 2 AND "user_actions"."acting_user_id" = 828 GROUP BY "user_actions"."user_id" ORDER BY COUNT(*) DESC LIMIT 6