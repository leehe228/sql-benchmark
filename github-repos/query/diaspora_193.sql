SELECT COUNT(*) FROM (SELECT DISTINCT photos.* FROM `photos` LEFT OUTER JOIN share_visibilities ON share_visibilities.shareable_id = photos.id AND share_visibilities.shareable_type = 'Photo' WHERE `photos`.`author_id` = 3499 AND (`share_visibilities`.`user_id` = 1 OR `photos`.`public` = TRUE) AND (photos.created_at < '2020-04-29 10:13:01.826963') AND `photos`.`pending` = FALSE ORDER BY `photos`.`created_at` DESC) subquery_for_count