SELECT COUNT(*) AS count_all, topic_id AS topic_id FROM "incoming_links" INNER JOIN "posts" ON "posts"."id" = "incoming_links"."post_id" AND ("posts"."deleted_at" IS NOT NULL) INNER JOIN "topics" ON "topics"."id" = "posts"."topic_id" AND ("topics"."deleted_at" IS NOT NULL) WHERE (topics.archetype = 'regular') AND ("topics"."deleted_at" IS NOT NULL) AND (incoming_links.created_at > '2009-12-02 06:00:00' AND incoming_links.created_at < '2010-01-01 23:59:59.999999' AND topic_id IS NOT NULL) GROUP BY topic_id