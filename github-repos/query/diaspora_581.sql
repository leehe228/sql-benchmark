SELECT DISTINCT posts.* FROM `posts` INNER JOIN `taggings` ON `taggings`.`taggable_id` = `posts`.`id` AND `taggings`.`taggable_type` = 'Post' LEFT OUTER JOIN share_visibilities ON share_visibilities.shareable_id = posts.id AND share_visibilities.shareable_type = 'Post' WHERE `posts`.`type` IN ('StatusMessage') AND (`share_visibilities`.`user_id` = 127 OR (`posts`.`public` = TRUE OR `posts`.`author_id` = 1031)) AND (taggings.tag_id IN (367)) AND (posts.created_at < '2020-04-28 06:05:22') AND `posts`.`type` IN ('StatusMessage', 'Reshare') AND `posts`.`public` = TRUE AND (posts.created_at < '2021-04-28T06:05:21.000Z') ORDER BY posts.created_at DESC, posts.id DESC LIMIT 15