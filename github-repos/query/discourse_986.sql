SELECT "group_users"."group_id" FROM "group_users" WHERE "group_users"."group_id" IN (SELECT "groups"."id" FROM "groups" LEFT JOIN group_users gu ON gu.group_id = groups.id WHERE (groups.id > 0) AND ( groups.id IN ( SELECT id FROM groups WHERE visibility_level = 0 UNION ALL SELECT id FROM groups WHERE visibility_level = 1 AND 763 IS NOT NULL UNION ALL SELECT g.id FROM groups g JOIN group_users gu ON gu.group_id = g.id AND gu.user_id = 763 WHERE g.visibility_level = 2 UNION ALL SELECT g.id FROM groups g LEFT JOIN group_users gu ON gu.group_id = g.id AND gu.user_id = 763 AND gu.owner WHERE g.visibility_level = 3 AND (gu.id IS NOT NULL OR TRUE) UNION ALL SELECT g.id FROM groups g JOIN group_users gu ON gu.group_id = g.id AND gu.user_id = 763 AND gu.owner WHERE g.visibility_level = 4 ) ) AND (groups.id > 0) AND ( groups.id IN ( SELECT id FROM groups WHERE members_visibility_level = 0 UNION ALL SELECT id FROM groups WHERE members_visibility_level = 1 AND 763 IS NOT NULL UNION ALL SELECT g.id FROM groups g JOIN group_users gu ON gu.group_id = g.id AND gu.user_id = 763 WHERE g.members_visibility_level = 2 UNION ALL SELECT g.id FROM groups g LEFT JOIN group_users gu ON gu.group_id = g.id AND gu.user_id = 763 AND gu.owner WHERE g.members_visibility_level = 3 AND (gu.id IS NOT NULL OR TRUE) UNION ALL SELECT g.id FROM groups g JOIN group_users gu ON gu.group_id = g.id AND gu.user_id = 763 AND gu.owner WHERE g.members_visibility_level = 4 ) ) AND (gu.user_id = 780) ORDER BY name ASC) AND "group_users"."user_id" = 763 AND "group_users"."owner" = TRUE