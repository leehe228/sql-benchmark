SELECT t2.SAL, SUM(EMP0.COMM), MIN(MIN(DISTINCT EMP.COMM)), SUM(t8.SAL) FROM (SELECT EMP0.SAL, SUM(EMP0.COMM) FROM EMP AS EMP0 GROUP BY EMP0.SAL) AS t2 INNER JOIN (SELECT t4.SAL, MIN(MIN(DISTINCT EMP.COMM)) FROM (SELECT EMP1.SAL, EMP1.COMM FROM EMP AS EMP1 GROUP BY EMP1.SAL, EMP1.COMM) AS t4 GROUP BY t4.SAL) AS t5 ON t2.SAL IS NOT DISTINCT FROM t5.SAL INNER JOIN (SELECT t8.SAL, SUM(t8.SAL) FROM (SELECT EMP2.SAL FROM EMP AS EMP2 GROUP BY EMP2.SAL) AS t8 GROUP BY t8.SAL) AS t9 ON t2.SAL IS NOT DISTINCT FROM t9.SAL
