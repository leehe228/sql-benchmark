SELECT EMP.EMPNO FROM EMP AS EMP WHERE EMP.EMPNO < CASE WHEN EMP.DEPTNO IN (SELECT CASE WHEN TRUE THEN EMP0.DEPTNO ELSE NULL END FROM EMP AS EMP0 WHERE EMP0.EMPNO < 20) = TRUE THEN 10 WHEN EMP.DEPTNO IN (SELECT CASE WHEN TRUE THEN EMP1.DEPTNO ELSE NULL END FROM EMP AS EMP1 WHERE EMP1.EMPNO < 20) = FALSE THEN 20 ELSE 30 END