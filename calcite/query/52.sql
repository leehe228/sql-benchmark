SELECT EMP1.EMPNO, EMP1.ENAME, EMP1.JOB, EMP1.MGR, EMP1.HIREDATE, EMP1.SAL, EMP1.COMM, EMP1.DEPTNO, EMP1.SLACKER FROM EMP AS EMP1 LEFT JOIN (SELECT t3.ENAME, COUNT(*) AS c, COUNT(t3.EMPNO) AS ck FROM (SELECT EMP2.ENAME, EMP2.EMPNO, EMP2.SAL AS R FROM EMP AS EMP2) AS t3 WHERE t3.R > 2 GROUP BY t3.ENAME) AS t7 ON EMP1.ENAME = t7.ENAME LEFT JOIN (SELECT t8.EMPNO, 1 AS i, t8.ENAME FROM (SELECT EMP3.ENAME, EMP3.EMPNO, EMP3.SAL AS R FROM EMP AS EMP3) AS t8 WHERE t8.R > 2) AS t11 ON EMP1.EMPNO = t11.EMPNO AND EMP1.ENAME = t11.ENAME SELECT `EMP1`.`empno` AS `EMPNO`, `EMP1`.`ename` AS `ENAME`, `EMP1`.`job` AS `JOB`, `EMP1`.`mgr` AS `MGR`, `EMP1`.`hiredate` AS `HIREDATE`, `EMP1`.`sal` AS `SAL`, `EMP1`.`comm` AS `COMM`, `EMP1`.`deptno` AS `DEPTNO`, `EMP1`.`slacker` AS `SLACKER` FROM `emp` AS `EMP1` INNER JOIN (SELECT `EMP2`.`ename` AS `ENAME`, COUNT(*) AS `c`, COUNT(`EMP2`.`empno`) AS `ck` FROM `emp` AS `EMP2` WHERE `EMP2`.`sal` > 2 GROUP BY `EMP2`.`ename`) AS `t7` ON `EMP1`.`ename` = `t7`.`ENAME` LEFT JOIN (SELECT `t8`.`EMPNO` AS `EMPNO`, 1 AS `i`, `t8`.`ENAME` AS `ENAME` FROM (SELECT `EMP3`.`ename` AS `ENAME`, `EMP3`.`empno` AS `EMPNO`, `EMP3`.`sal` AS `R` FROM `emp` AS `EMP3`) AS `t8` WHERE `t8`.`R` > 2) AS `t11` ON `EMP1`.`empno` = `t11`.`EMPNO` AND `EMP1`.`ename` = `t11`.`ENAME` WHERE `t7`.`c` = 0 OR `t11`.`i` IS NULL OR `t7`.`ck` >= `t7`.`c`