SELECT t2.DEPTNO, SUM(t2.sum1), SUM(SUM(SUM(DISTINCT t2.SAL))), MAX(MAX(t2.DEPTNO)), MAX(MAX(t2.max2)) FROM (SELECT EMP0.DEPTNO, EMP0.SAL, SUM(EMP0.DEPTNO) as sum1, MAX(EMP0.DEPTNO) as max1, MAX(EMP0.COMM) as max2 FROM EMP AS EMP0 GROUP BY EMP0.DEPTNO, EMP0.SAL) AS t2 GROUP BY t2.DEPTNO