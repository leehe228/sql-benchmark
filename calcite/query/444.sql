SELECT EMP2.EMPNO FROM EMP AS EMP2 JOIN (SELECT COUNT(*) AS c, COUNT(CASE WHEN TRUE THEN EMP3.DEPTNO ELSE NULL END) AS ck FROM EMP AS EMP3 WHERE EMP3.EMPNO < 20) AS t7 LEFT JOIN (SELECT CASE WHEN TRUE THEN EMP4.DEPTNO ELSE NULL END, 1 AS i FROM EMP AS EMP4 WHERE EMP4.EMPNO < 20 GROUP BY CASE WHEN TRUE THEN EMP4.DEPTNO ELSE NULL END, TRUE) AS t11 ON EMP2.DEPTNO = CASE WHEN TRUE THEN EMP4.DEPTNO ELSE NULL END WHERE EMP2.EMPNO < CASE WHEN CASE WHEN t7.c = 0 THEN FALSE WHEN t11.i IS NOT NULL THEN TRUE WHEN t7.ck < t7.c THEN NULL ELSE FALSE END = TRUE THEN 10 WHEN CASE WHEN t7.c = 0 THEN FALSE WHEN t11.i IS NOT NULL THEN TRUE WHEN t7.ck < t7.c THEN NULL ELSE FALSE END = FALSE THEN 20 ELSE 30 END